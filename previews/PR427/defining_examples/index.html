<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Defining a bijector: examples · Bijectors</title><meta name="title" content="Defining a bijector: examples · Bijectors"/><meta property="og:title" content="Defining a bijector: examples · Bijectors"/><meta property="twitter:title" content="Defining a bijector: examples · Bijectors"/><meta name="description" content="Documentation for Bijectors."/><meta property="og:description" content="Documentation for Bijectors."/><meta property="twitter:description" content="Documentation for Bijectors."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body>
<!-- NAVBAR START -->
<style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap');

    /* Documenter.jl CSS Overrides */
    html {
        scroll-padding-top: calc(var(--navbar-height) + 1rem);
    }
    .docs-sidebar, #documenter {
        margin-top: var(--navbar-height);
    }
    .docs-version-selector {
        margin-bottom: 60px !important;
    }
    @media screen and (max-width: 1056px) {
        .docs-version-selector {
            margin-bottom: 60px !important;
        }
        .docs-sidebar {
            margin-top: 0 !important;
        }
    }
    /* End of Documenter.jl Tweaks */

    /* Color and Font Variables */
    :root {
        --heading-color: #6c757d;
        --item-color: rgb(165, 165, 165);
        --primary-bg: white;
        --hover-color: #8faad2;
        --deprecated-bg: #ff4d4d;
        --deprecated-text: white;
        --icon-color: #6c757d;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e9ecef;
        
        /* Typography */
        --font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        --nav-link-font-size: 1.0625rem;
        --turing-title-font-size: 21.25px;
        --icon-font-size: 1.25rem;
        --dropdown-arrow-font-size: 0.6875rem;
        --badge-font-size: 0.75rem;

        /* Sizing and Spacing */
        --navbar-height: 3.75rem;
        --logo-height: 31px;
        --logo-width: auto;
        --logo-padding-top: 7px;
        --logo-margin-left: 0.8rem;
        --title-margin-left: 0.4px;
        --title-nav-spacing: 1.1rem;
        --nav-item-margin-left: 1.3rem;
        --icon-margin-left: 1rem;
        --dropdown-padding: 1.875rem;
        --dropdown-item-width: 12.5rem;
        --dropdown-subitem-width: 15.625rem;
        --dropdown-subitem-padding: 0.125rem 0.625rem;
    }

    /* Dark Theme Variable Overrides */
    html.theme--documenter-dark {
        --heading-color: #e0e0e0;
        --item-color: #bdbdbd;
        --primary-bg: #1f2424;
        --hover-color: #ffffff;
        --icon-color: #e0e0e0;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #424242;
    }

    /* Catppuccin Theme Overrides */
    html.theme--catppuccin-latte {
        --heading-color: #4c4f69;
        --primary-bg: #eff1f5;
        --icon-color: #4c4f69;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e6e9ef;
    }
    html.theme--catppuccin-frappe {
        --heading-color: #c6d0f5;
        --primary-bg: #303446;
        --icon-color: #c6d0f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #51576d;
    }
    html.theme--catppuccin-macchiato {
        --heading-color: #cad3f5;
        --primary-bg: #24273a;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #494d64;
    }
    html.theme--catppuccin-mocha {
        --heading-color: #cad3f5;
        --primary-bg: #1e1e2e;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #45475a;
    }


    /* Main Navigation Bar */
    .ext-navigation {
        font-family: var(--font-family);
        position: fixed;
        height: var(--navbar-height);
        top: 0;
        width: 100%;
        background-color: var(--primary-bg);
        z-index: 1000;
        box-shadow: 0 2px 4px var(--shadow-color);
        display: flex;
        align-items: center;
        padding: 0 1.0625rem;
        transition: transform 0.3s, background-color 0.3s;
    }

    nav.ext-navigation .ext-navbar-logo {
        margin-left: var(--logo-margin-left);
        height: auto;
        max-height: var(--logo-height);
        width: auto;
        padding-top: var(--logo-padding-top);
    }
    
    /* Theme-aware logo text color */
    .ext-navbar-logo .logo-text {
        fill: var(--heading-color);
    }
    
    .ext-navbar-title {
        color: var(--heading-color) !important;
        font-size: var(--turing-title-font-size) !important;
        margin-left: var(--title-margin-left);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    .ext-navbar-title:hover {
        color: var(--hover-color) !important;
    }

    .ext-nav-links {
        display: flex;
        align-items: center;
        list-style-type: none;
        margin: 0;
        padding: 0;
        flex-grow: 1;
        margin-left: var(--title-nav-spacing);
    }

    .ext-nav-links li:first-child {
        margin-left: 0 !important;
    }

    .ext-nav-links li {
        margin-left: var(--nav-item-margin-left) !important;
    }

    .ext-nav-link {
        color: var(--heading-color) !important;
        text-decoration: none;
        font-size: var(--nav-link-font-size) !important;
        transition: color 0.2s ease;
        cursor: pointer;
    }

    .ext-nav-link:hover,
    .ext-navbar-item-single a:hover,
    .ext-navbar-icons a:hover {
        color: var(--hover-color) !important;
    }

    .ext-navbar-item-single a {
        color: var(--heading-color) !important;
    }
    
    .ext-navbar-icons {
        display: flex;
        align-items: center;
    }

    .ext-navbar-icons a {
        color: var(--icon-color) !important;
        font-size: var(--icon-font-size) !important;
        transition: color 0.2s ease;
        margin-left: var(--icon-margin-left);
    }

    .ext-menu-toggle {
        display: none;
        font-size: 1.5rem;
        color: var(--heading-color);
        cursor: pointer;
    }

    .ext-dropdown {
        display: none;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        padding: var(--dropdown-padding);
        position: absolute;
        top: var(--navbar-height);
        width: 100%;
        left: 0;
        background-color: var(--primary-bg);
        line-height: 1.875rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, background-color 0.3s;
        transform: translateY(-0.625rem);
        box-shadow: 0 4px 6px var(--shadow-color);
    }

    #library-handler::after {
        content: "▼";
        font-size: var(--dropdown-arrow-font-size);
        margin-left: 0.3125rem;
        transition: transform 0.3s ease-in-out;
    }

    #library-handler.open::after {
        content: "▲";
    }

    .ext-dropdown.show {
        display: grid;
        opacity: 1;
        transform: translateY(0);
    }

    .ext-dropdown ul {
        width: var(--dropdown-item-width);
        margin-bottom: 1.25rem;
    }

    .ext-dropdown ul li {
        text-align: left;
        display: flex;
        align-items: center;
    }

    .ext-dropdown ul a li {
        color: var(--item-color);
        width: var(--dropdown-subitem-width);
        border-radius: 3px;
        padding: var(--dropdown-subitem-padding);
        transition: background-color 0.2s ease;
    }

    .ext-dropdown ul a li:hover {
        background-color: var(--dropdown-hover-bg);
    }

    .ext-dropdown-item-heading {
        color: var(--heading-color);
        text-align: center;
    }

    .deprecated-badge {
        background-color: var(--deprecated-bg);
        color: var(--deprecated-text);
        font-size: var(--badge-font-size);
        padding: .1rem;
        border-radius: 3px;
        margin-left: 0.5rem;
        line-height: 1;
    }

    @media (max-width: 966px) {
        .ext-dropdown {
            grid-template-columns: 1fr 1fr 1fr;
        }
    }

    @media (max-width: 768px) {
        .ext-nav-links {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            background-color: var(--primary-bg);
            position: absolute;
            top: var(--navbar-height);
            left: 0;
            padding: 0.625rem 0;
            height: auto;
            overflow-y: auto;
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-left: 0;
        }

        .ext-nav-links.show {
            display: flex;
        }

        .ext-nav-links li {
            margin: 0.625rem 0 !important;
            text-align: center;
        }
        
        .ext-menu-toggle {
            display: block;
            margin-left: auto;
        }

        .ext-navigation.hide {
            transform: translateY(calc(-1 * var(--navbar-height)));
        }

        .ext-dropdown {
            position: static;
            display: block;
            opacity: 1;
            transform: none;
            box-shadow: none;
            grid-template-columns: 1fr;
            padding: 0.625rem;
            text-align: center;
        }

        .ext-dropdown ul {
            width: auto;
            display: inline-block;
            margin: 0 auto 0.3125rem;
            text-align: left;
        }
    }
</style>
<nav class="ext-navigation">
    <a href="https://turinglang.org/">
        <svg width="4333" height="1145" viewBox="0 0 4333 1145" fill="none" xmlns="http://www.w3.org/2000/svg" class="ext-navbar-logo">
            <path class="logo-text" d="M0.44603 193.181V66.9868H663.471V193.181H406.62V898H257.297V193.181H0.44603ZM1097.24 635.874V274.74H1244.13V898H1101.7V787.225H1095.21C1081.14 822.121 1058.01 850.66 1025.82 872.842C993.902 895.024 954.542 906.115 907.744 906.115C866.896 906.115 830.783 897.053 799.403 878.929C768.295 860.534 743.948 833.889 726.365 798.993C708.782 763.826 699.99 721.356 699.99 671.581V274.74H846.878V648.858C846.878 688.353 857.699 719.733 879.34 742.997C900.981 766.261 929.385 777.893 964.551 777.893C986.192 777.893 1007.16 772.618 1027.45 762.068C1047.73 751.518 1064.37 735.828 1077.35 714.999C1090.61 693.899 1097.24 667.524 1097.24 635.874ZM1395.17 898V274.74H1537.6V378.617H1544.09C1555.45 342.639 1574.93 314.911 1602.52 295.434C1630.38 275.687 1662.17 265.813 1697.88 265.813C1705.99 265.813 1715.05 266.219 1725.06 267.031C1735.34 267.572 1743.86 268.518 1750.63 269.871V404.992C1744.4 402.828 1734.53 400.934 1721 399.311C1707.75 397.417 1694.9 396.471 1682.46 396.471C1655.68 396.471 1631.6 402.287 1610.23 413.919C1589.13 425.28 1572.49 441.105 1560.32 461.393C1548.15 481.682 1542.06 505.081 1542.06 531.591V898H1395.17ZM1848.21 898V274.74H1995.1V898H1848.21ZM1922.06 186.283C1898.8 186.283 1878.78 178.573 1862.01 163.154C1845.24 147.464 1836.85 128.664 1836.85 106.752C1836.85 84.5701 1845.24 65.7695 1862.01 50.3503C1878.78 34.6606 1898.8 26.8158 1922.06 26.8158C1945.6 26.8158 1965.61 34.6606 1982.12 50.3503C1998.89 65.7695 2007.27 84.5701 2007.27 106.752C2007.27 128.664 1998.89 147.464 1982.12 163.154C1965.61 178.573 1945.6 186.283 1922.06 186.283ZM2293.04 532.809V898H2146.15V274.74H2286.54V380.646H2293.85C2308.18 345.75 2331.04 318.022 2362.42 297.463C2394.07 276.904 2433.16 266.625 2479.69 266.625C2522.7 266.625 2560.17 275.822 2592.09 294.217C2624.28 312.612 2649.17 339.257 2666.75 374.153C2684.6 409.049 2693.39 451.385 2693.12 501.159V898H2546.24V523.882C2546.24 482.223 2535.41 449.626 2513.77 426.092C2492.4 402.557 2462.78 390.79 2424.91 390.79C2399.21 390.79 2376.35 396.471 2356.34 407.832C2336.59 418.923 2321.03 435.019 2309.67 456.119C2298.58 477.218 2293.04 502.782 2293.04 532.809ZM3113.5 1144.71C3060.75 1144.71 3015.44 1137.54 2977.57 1123.2C2939.7 1109.13 2909.26 1090.2 2886.27 1066.39C2863.28 1042.59 2847.32 1016.21 2838.39 987.269L2970.67 955.213C2976.62 967.386 2985.28 979.424 2996.64 991.327C3008 1003.5 3023.28 1013.51 3042.49 1021.35C3061.97 1029.47 3086.45 1033.53 3115.93 1033.53C3157.59 1033.53 3192.08 1023.38 3219.4 1003.09C3246.73 983.076 3260.39 950.074 3260.39 904.087V786.008H3253.08C3245.51 801.157 3234.42 816.711 3219.81 832.671C3205.47 848.632 3186.4 862.022 3162.6 872.842C3139.06 883.663 3109.44 889.073 3073.73 889.073C3025.85 889.073 2982.44 877.847 2943.48 855.394C2904.8 832.671 2873.96 798.857 2850.97 753.952C2828.24 708.777 2816.88 652.24 2816.88 584.341C2816.88 515.902 2828.24 458.147 2850.97 411.078C2873.96 363.739 2904.93 327.896 2943.89 303.55C2982.84 278.933 3026.26 266.625 3074.14 266.625C3110.66 266.625 3140.69 272.847 3164.22 285.29C3188.03 297.463 3206.96 312.206 3221.03 329.519C3235.09 346.561 3245.78 362.657 3253.08 377.805H3261.2V274.74H3406.06V908.144C3406.06 961.435 3393.34 1005.53 3367.92 1040.42C3342.49 1075.32 3307.73 1101.43 3263.63 1118.74C3219.54 1136.05 3169.5 1144.71 3113.5 1144.71ZM3114.72 773.835C3145.83 773.835 3172.34 766.261 3194.25 751.112C3216.16 735.963 3232.79 714.187 3244.16 685.783C3255.52 657.379 3261.2 623.295 3261.2 583.53C3261.2 544.305 3255.52 509.95 3244.16 480.465C3233.07 450.979 3216.56 428.12 3194.65 411.89C3173.01 395.389 3146.37 387.138 3114.72 387.138C3081.98 387.138 3054.66 395.659 3032.75 412.701C3010.84 429.744 2994.34 453.143 2983.25 482.899C2972.16 512.385 2966.61 545.929 2966.61 583.53C2966.61 621.672 2972.16 655.08 2983.25 683.754C2994.61 712.158 3011.25 734.34 3033.16 750.3C3055.34 765.99 3082.53 773.835 3114.72 773.835ZM3647.08 906.927C3622.47 906.927 3601.37 898.271 3583.78 880.958C3566.2 863.645 3557.54 842.545 3557.82 817.658C3557.54 793.312 3566.2 772.482 3583.78 755.17C3601.37 737.857 3622.47 729.2 3647.08 729.2C3670.89 729.2 3691.58 737.857 3709.17 755.17C3727.02 772.482 3736.08 793.312 3736.35 817.658C3736.08 834.159 3731.75 849.173 3723.37 862.698C3715.25 876.224 3704.43 887.044 3690.91 895.16C3677.65 903.004 3663.04 906.927 3647.08 906.927ZM3888.01 274.74H4034.9V933.708C4034.9 978.613 4026.38 1015.67 4009.33 1044.89C3992.29 1074.1 3967.67 1095.88 3935.48 1110.22C3903.29 1124.55 3864.2 1131.72 3818.22 1131.72C3812.81 1131.72 3807.8 1131.59 3803.2 1131.32C3798.6 1131.32 3793.6 1131.18 3788.19 1130.91V1011.21C3792.25 1011.48 3795.9 1011.62 3799.15 1011.62C3802.39 1011.89 3805.77 1012.02 3809.29 1012.02C3837.42 1012.02 3857.58 1005.12 3869.75 991.327C3881.92 977.801 3888.01 957.918 3888.01 931.679V274.74ZM3961.05 186.283C3937.51 186.283 3917.36 178.573 3900.59 163.154C3884.09 147.464 3875.84 128.664 3875.84 106.752C3875.84 84.5701 3884.09 65.7695 3900.59 50.3503C3917.36 34.6606 3937.51 26.8158 3961.05 26.8158C3984.31 26.8158 4004.19 34.6606 4020.7 50.3503C4037.47 65.7695 4045.85 84.5701 4045.85 106.752C4045.85 128.664 4037.47 147.464 4020.7 163.154C4004.19 178.573 3984.31 186.283 3961.05 186.283ZM4332.83 66.9868V898H4185.94V66.9868H4332.83Z" fill="currentColor"/>
            <path d="M4076 108.5C4076 168.424 4027.42 217 3967.5 217C3907.58 217 3859 168.424 3859 108.5C3859 48.5762 3907.58 0 3967.5 0C4027.42 0 4076 48.5762 4076 108.5Z" fill="#389725"/>
            <path d="M3755 814.5C3755 874.424 3706.42 923 3646.5 923C3586.58 923 3538 874.424 3538 814.5C3538 754.576 3586.58 706 3646.5 706C3706.42 706 3755 754.576 3755 814.5Z" fill="#9457B1"/>
            <path d="M2030 108.5C2030 168.424 1981.42 217 1921.5 217C1861.58 217 1813 168.424 1813 108.5C1813 48.5762 1861.58 0 1921.5 0C1981.42 0 2030 48.5762 2030 108.5Z" fill="#CA3B33"/>
        </svg>
    </a>
    <!-- <a class="ext-navbar-title" href="https://turinglang.org/">Turing.jl</a> -->
    
    <ul class="ext-nav-links">
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/getting-started/">Get Started</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/">Tutorials</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/faq/">FAQ</a></li>
        <li>
            <p class="ext-nav-link" id="library-handler">Libraries</p>
            <div class="ext-dropdown" id="ext-dropdown-items">
                <ul>
                    <li class="ext-dropdown-item-heading">Modelling Languages</li>
                    <a href="https://turinglang.org/DynamicPPL.jl/"><li>DynamicPPL</li></a>
                    <a href="https://turinglang.org/JuliaBUGS.jl/"><li>JuliaBUGS</li></a>
                    <a href="https://turinglang.org/TuringGLM.jl/"><li>TuringGLM</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">MCMC</li>
                    <a href="https://turinglang.org/AdvancedHMC.jl/"><li>AdvancedHMC</li></a>
                    <a href="https://turinglang.org/AbstractMCMC.jl/"><li>AbstractMCMC</li></a>
                    <a href="https://github.com/theogf/ThermodynamicIntegration.jl"><li>ThermodynamicIntegration</li></a>
                    <a href="https://turinglang.org/AdvancedPS.jl/"><li>AdvancedPS</li></a>
                    <a href="https://turinglang.org/SliceSampling.jl/"><li>SliceSampling</li></a>
                    <a href="https://turinglang.org/EllipticalSliceSampling.jl/"><li>EllipticalSliceSampling</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Diagnostics</li>
                    <a href="https://turinglang.org/MCMCChains.jl/"><li>MCMCChains</li></a>
                    <a href="https://turinglang.org/MCMCDiagnosticTools.jl/"><li>MCMCDiagnosticTools</li></a>
                    <a href="https://chalk-lab.github.io/ParetoSmooth.jl/"><li>ParetoSmooth</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Gaussian Processes</li>
                    <a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/"><li>AbstractGPs</li></a>
                    <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/"><li>KernelFunctions</li></a>
                    <a href="https://juliagaussianprocesses.github.io/ApproximateGPs.jl/"><li>ApproximateGPs</li></a>
                </ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Bijectors.jl/">Bijectors</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringCallbacks.jl/">TuringCallbacks</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Deprecated/TuringBenchmarking/">TuringBenchmarking</a><span class="deprecated-badge">Deprecated</span></li></ul>
            </div>
        </li>
        <li><a class="ext-nav-link" href="https://turinglang.org/news/">News</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/team/">Team</a></li>
    </ul>

    <div class="ext-navbar-icons">
        <a href="https://x.com/TuringLang" aria-label="Turing on X"><i class="fa-brands fa-x-twitter"></i></a>
        <a href="https://discourse.julialang.org/c/domain/probprog/48" aria-label="Turing on Discourse"><i class="fa-brands fa-discourse"></i></a>
        <a href="https://julialang.slack.com/archives/CCYDC34A0" aria-label="Turing on Slack"><i class="fa-brands fa-slack"></i></a>
        <a href="https://github.com/TuringLang/" aria-label="Turing.jl on GitHub"><i class="fa-brands fa-github"></i></a>
    </div>

    <span class="ext-menu-toggle"><i class="fa-solid fa-bars"></i></span>
</nav>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".ext-menu-toggle");
        const navLinks = document.querySelector(".ext-nav-links");
        const nav = document.querySelector(".ext-navigation");
        const libraryHandler = document.getElementById("library-handler");
        const dropdownContainer = document.getElementById("ext-dropdown-items");
        let lastScrollY = window.scrollY;

        function closeDropdown() {
            if (dropdownContainer.classList.contains("show")) {
                libraryHandler.classList.remove("open");
                dropdownContainer.classList.remove("show");
                setTimeout(() => {
                    if (!dropdownContainer.classList.contains("show")) {
                        dropdownContainer.style.display = "none";
                    }
                }, 300);
            }
        }

        function openDropdown() {
            dropdownContainer.style.display = "grid";
            libraryHandler.classList.add("open");
            setTimeout(() => {
                dropdownContainer.classList.add("show");
            }, 10);
        }

        function setAppropriateHeight() {
            if (window.innerWidth <= 768) {
                const viewportHeight = window.innerHeight;
                const navHeight = nav.offsetHeight;
                navLinks.style.maxHeight = `${viewportHeight - navHeight}px`;
                navLinks.style.overflowY = "auto";
            } else {
                navLinks.style.maxHeight = "";
                navLinks.style.overflowY = "";
            }
        }

        menuToggle.addEventListener("click", (event) => {
            event.stopPropagation();
            navLinks.classList.toggle("show");
            if (navLinks.classList.contains("show")) {
                setAppropriateHeight();
                closeDropdown();
                dropdownContainer.style.display = "none";
            }
        });

        libraryHandler.addEventListener("click", (event) => {
            event.stopPropagation();
            event.preventDefault();
            if (dropdownContainer.classList.contains("show")) {
                closeDropdown();
            } else {
                openDropdown();
            }
            setAppropriateHeight();
        });

        // Close all menus if a click is registered outside the navigation bar.
        document.addEventListener("click", (event) => {
            if (!nav.contains(event.target)) {
                navLinks.classList.remove("show");
                closeDropdown();
            }
        });

        // Hide navigation bar on scroll down in mobile view.
        window.addEventListener("scroll", () => {
            if (window.innerWidth <= 768) {
                if (window.scrollY > lastScrollY && window.scrollY > nav.offsetHeight){
                    nav.classList.add("hide");
                } else {
                    nav.classList.remove("hide");
                }
                lastScrollY = window.scrollY;
            }
        });

        window.addEventListener("resize", setAppropriateHeight);
    });
</script>
<!-- NAVBAR END -->



<div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bijectors</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Bijectors.jl</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../distributions/">Usage with distributions</a></li><li><a class="tocitem" href="../types/">Types API</a></li><li><a class="tocitem" href="../defining/">Defining a bijector</a></li><li class="is-active"><a class="tocitem" href>Defining a bijector: examples</a><ul class="internal"><li><a class="tocitem" href="#Cyclic-permutation"><span>Cyclic permutation</span></a></li><li><a class="tocitem" href="#Stereographic-projection"><span>Stereographic projection</span></a></li></ul></li><li><a class="tocitem" href="../advi/">Example: Variational inference</a></li><li><a class="tocitem" href="../flows/">Example: Normalizing flows</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Defining a bijector: examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Defining a bijector: examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/Bijectors.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TuringLang/Bijectors.jl/blob/main/docs/src/defining_examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Defining-a-bijector:-examples"><a class="docs-heading-anchor" href="#Defining-a-bijector:-examples">Defining a bijector: examples</a><a id="Defining-a-bijector:-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-bijector:-examples" title="Permalink"></a></h1><p>Here we provide two different worked examples of defining a custom bijector.</p><h2 id="Cyclic-permutation"><a class="docs-heading-anchor" href="#Cyclic-permutation">Cyclic permutation</a><a id="Cyclic-permutation-1"></a><a class="docs-heading-anchor-permalink" href="#Cyclic-permutation" title="Permalink"></a></h2><p>We start with something simple: a bijector that performs a cyclic permutation of the elements of a vector.</p><pre><code class="language-julia hljs">using Bijectors

struct CircShift &lt;: Bijector
    shift::Int
end</code></pre><p>As described in the <a href="../defining/">previous page</a>, the only function you absolutely <em>must</em> implement is <code>with_logabsdet_jacobian</code>.</p><p>Let&#39;s think for a moment about what the Jacobian is. <code>CircShift</code> is a mapping from <code>ℝⁿ → ℝⁿ</code> that permutes the elements of the input vector. For example, <code>CircShift(1)</code> would map a length-3 vector <code>x = [x1, x2, x3]</code> to <code>y = [x3, x1, x2]</code>.</p><p>That means that the Jacobian matrix is</p><p class="math-container">\[J = \begin{bmatrix}
\partial y_1/\partial x_1 &amp; \partial y_1/\partial x_2 &amp; \partial y_1/\partial x_3 \\
\partial y_2/\partial x_1 &amp; \partial y_2/\partial x _2 &amp; \partial y_2/\partial x_3 \\
\partial y_3/\partial x_1 &amp; \partial y_3/\partial x_2 &amp; \partial y_3/\partial x_3
\end{bmatrix}
= \begin{bmatrix}
0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0
\end{bmatrix}.\]</p><p>In general, the Jacobian of such a transformation is a <a href="https://en.wikipedia.org/wiki/Permutation_matrix">permutation matrix</a>. The determinant of a permutation matrix is either <code>1</code> or <code>-1</code>, depending on whether the permutation is even or odd. (In this case, it is even; but it could be odd for other shifts and/or input sizes.) This means that the log-absolute determinant of the Jacobian is always <code>0</code>.</p><p>We can now implement <code>with_logabsdet_jacobian</code>.</p><pre><code class="language-julia hljs">function Bijectors.with_logabsdet_jacobian(
    b::CircShift, x::AbstractVector{T}
) where {T&lt;:Real}
    y = circshift(x, b.shift)
    return y, zero(T)
end</code></pre><p>It is good practice to let the type of the input determine the type of the log-Jacobian term here. However, you might also ask: since a cyclic permutation is also well-defined for arrays of non-real types, should we also allow that? We can do so by creating a new method, but we would have to make a choice as to the type of the log-Jacobian term, since we cannot derive it from the input type. Here, we will choose <code>Float64</code>:</p><pre><code class="language-julia hljs">import ChangesOfVariables: with_logabsdet_jacobian

function with_logabsdet_jacobian(b::CircShift, x::AbstractVector)
    y = circshift(x, b.shift)
    return y, 0.0
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">with_logabsdet_jacobian (generic function with 77 methods)</code></pre><p>With this defined, we can now benefit from a host of automatic definitions:</p><pre><code class="language-julia hljs">b = CircShift(1)
x = [1.0, 2.0, 3.0]
b(x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
 3.0
 1.0
 2.0</code></pre><pre><code class="language-julia hljs">logabsdetjac(b, x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>We can also define the inverse bijector. A default definition for <code>inverse(b)</code> already exists: it would return <code>Bijectors.Inverse(b)</code>. But, if we used this default definition, we would have to also define <code>with_logabsdet_jacobian(::Inverse{CircShift}, y)</code>. We can save ourselves this hassle by overloading the method:</p><pre><code class="language-julia hljs">import InverseFunctions: inverse

inverse(b::CircShift) = CircShift(-b.shift)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">inverse (generic function with 117 methods)</code></pre><p>Now we can use the inverse bijector:</p><pre><code class="language-julia hljs">y = b(x)
inverse(b)(y) == x</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><div class="admonition is-info" id="Note-45e0c81c853312b4"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-45e0c81c853312b4" title="Permalink"></a></header><div class="admonition-body"><p>Bijectors re-exports both <code>with_logabsdet_jacobian</code> as well as <code>inverse</code>, so you don&#39;t need to import them separately if Bijectors is already a dependency. Conversely, if you don&#39;t want to depend on Bijectors.jl directly, you can just import these functions from their respective packages.</p></div></div><h2 id="Stereographic-projection"><a class="docs-heading-anchor" href="#Stereographic-projection">Stereographic projection</a><a id="Stereographic-projection-1"></a><a class="docs-heading-anchor-permalink" href="#Stereographic-projection" title="Permalink"></a></h2><p>Now, we&#39;ll look at a more complex example: a stereographic projection mapping points on the unit sphere (i.e., length-3 vectors <span>$x$</span> for which <span>$x_1^2 + x_2^2 + x_3^2 = 1$</span>), to points in the plane <code>ℝ²</code> (i.e., length-2 vectors <span>$y$</span> whose elements are unconstrained).</p><p>The relevant formulae are given <a href="https://en.wikipedia.org/wiki/Stereographic_projection#First_formulation">here on Wikipedia</a>. The forward transform (from sphere to plane) is:</p><p class="math-container">\[y_1 = \frac{x_1}{1 - x_3}; \qquad y_2 = \frac{x_2}{1 - x_3}\]</p><pre><code class="language-julia hljs">using Bijectors

struct StereographicProj &lt;: Bijector end
function (s::StereographicProj)(x::AbstractVector{T}) where {T&lt;:Real}
    y = similar(x, 2)
    denom = one(T) - x[3]
    y[1] = x[1] / denom
    y[2] = x[2] / denom
    return y
end</code></pre><div class="admonition is-warning" id="Warning-9c26e832bb30753c"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-9c26e832bb30753c" title="Permalink"></a></header><div class="admonition-body"><p>This will return <code>[Inf, Inf]</code> if <code>x[3] == 1</code> (the &#39;north pole&#39; of the sphere), which may potentially make downstream computations fail. One potential way around this is to add <code>eps(T)</code> to the denominator to avoid it ever being zero: you will sometimes see this trick used in Bijectors.jl. However, be aware that the reverse transform has to also be modified accordingly so that the two transforms remain inverses of each other!</p></div></div><p>When it comes to computing the Jacobian, we find ourselves in a spot of bother. The partial derivatives themselves can ostensibly be computed using fairly straightforward calculus:</p><p class="math-container">\[J = \begin{bmatrix}
\partial y_1/\partial x_1 &amp; \partial y_1/\partial x_2 &amp; \partial y_1/\partial x_3 \\
\partial y_2/\partial x_1 &amp; \partial y_2/\partial x_2 &amp; \partial y_2/\partial x_3
\end{bmatrix}
= \begin{bmatrix}
1/(1 - x_3) &amp; 0 &amp; x_1/(1 - x_3)^2 \\
0 &amp; 1/(1 - x_3) &amp; x_2/(1 - x_3)^2
\end{bmatrix}\]</p><p>but since our mapping is from <code>ℝ³ → ℝ²</code>, the Jacobian matrix is not square, and so we cannot compute its determinant!</p><p>To fix this, we need to realise that <span>$x_1$</span>, <span>$x_2$</span>, and <span>$x_3$</span> are not really independent at all. The partial derivatives we computed above treated them as independent variables! In reality, they must satisfy the constraint <span>$x_1^2 + x_2^2 + x_3^2 = 1$</span>, which means that</p><p class="math-container">\[x_3 = \pm \sqrt{1 - x_1^2 - x_2^2},\]</p><p>and thus</p><p class="math-container">\[\frac{\partial x_3}{\partial x_1} = -\frac{x_1}{x_3}; \qquad \frac{\partial x_3}{\partial x_2} = -\frac{x_2}{x_3}.\]</p><p>(Note that this is true regardless of which sign <span>$x_3$</span> has.)</p><p>In effect, we are treating <span>$x_3$</span> as a function of <span>$x_1$</span> and <span>$x_2$</span>, rather than as an independent variable. This means that we can construct a Jacobian using only <span>$x_1$</span> and <span>$x_2$</span> as inputs, and thus obtain a square Jacobian matrix.</p><p>For example, we can recompute the derivative of <span>$y_1$</span> with respect to <span>$x_1$</span>, but this time also making sure to include the dependence of <span>$x_3$</span> on <span>$x_1$</span>.</p><p class="math-container">\[\begin{align*}
\frac{\partial y_1}{\partial x_1}
&amp;= \frac{\partial}{\partial x_1} [x_1(1 - x_3)^{-1}] \\
&amp;= (1 - x_3)^{-1} + x_1 (-1)(1 - x_3)^{-2} \left(\frac{\partial}{\partial x_1}(1 - x_3)\right) \\
&amp;= (1 - x_3)^{-1} - x_1 (1 - x_3)^{-2} \left(\frac{x_1}{x_3}\right) \\
&amp;= \frac{1}{1 - x_3} - \frac{x_1^2}{x_3 (1 - x_3)^2}
\end{align*}\]</p><p>A similar strategy for all the other partial derivatives gives us the Jacobian</p><p class="math-container">\[J = \begin{bmatrix}
\dfrac{1}{1 - x_3} - \dfrac{x_1^2}{x_3 (1 - x_3)^2} &amp; -\dfrac{x_1 x_2}{x_3 (1 - x_3)^2} \\
-\dfrac{x_1 x_2}{x_3 (1 - x_3)^2} &amp; \dfrac{1}{1 - x_3} - \dfrac{x_2^2}{x_3 (1 - x_3)^2}
\end{bmatrix}.\]</p><div class="admonition is-info" id="Note-57e6da74b0446000"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-57e6da74b0446000" title="Permalink"></a></header><div class="admonition-body"><p>When you see <span>$x_3$</span> here, don&#39;t think &#39;the variable <span>$x_3$</span>&#39;: it&#39;s just shorthand for <span>$\pm \sqrt{1 - x_1^2 - x_2^2}$</span>. (And recall that these formulae hold for both choices of sign.)</p></div></div><p>Its determinant very nicely simplifies to</p><p class="math-container">\[\det(J) = -\frac{1}{x_3 (1 - x_3)^2},\]</p><p>the <em>absolute</em> determinant being</p><p class="math-container">\[|\det(J)| = \frac{1}{|x_3| (1 - x_3)^2},\]</p><p>(<code>(1 - x_3)^2</code> is always non-negative, of course); and thus</p><pre><code class="language-julia hljs">function Bijectors.logabsdetjac(b::StereographicProj, x::AbstractVector{T}) where {T&lt;:Real}
    return -log(abs(x[3])) - (2 * log(one(T) - x[3]))
end</code></pre><p>Phew!</p><p>Let&#39;s take a moment and check that we did indeed do this correctly. To verify that the implementation of <code>logabsdetjac</code> is indeed correct, we can compare it against a Jacobian obtained via <em>automatic differentiation</em>.</p><p>If we try to calculate a Jacobian for <code>StereographicProj()</code>, we will just get a 2x3 matrix, which is not what we want. So, we need to take an extra step to map from the independent coordinates of <span>$x$</span> (i.e., <span>$x_1$</span> and <span>$x_2$</span>) to the full 3D coordinates, and <em>then</em> to the plane:</p><pre><code class="language-julia hljs">sgn = 1

function full_transform(x12)
    x3 = sgn * sqrt(one(eltype(x12)) - sum(x12 .^ 2))
    x123 = vcat(x12, x3)
    return StereographicProj()(x123)
end

import DifferentiationInterface as DI
using FiniteDifferences, LinearAlgebra
x = [0.3, 0.4, sgn * sqrt(1 - 0.3^2 - 0.4^2)]

adtype = DI.AutoFiniteDifferences(; fdm=central_fdm(5, 1))
jac = DI.jacobian(full_transform, adtype, x[1:2])
logjac = logabsdet(jac)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4.164051191196659</code></pre><p>Hopefully this is approximately the same!</p><pre><code class="language-julia hljs">logabsdetjac(StereographicProj(), x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4.164051191195414</code></pre><p>You can also rerun the code blocks above with <code>sgn = -1</code> to verify that our <code>logabsdetjac</code> implementation does indeed behave correctly for both positive and negative values of <span>$x_3$</span>.</p><p>When writing unit tests for a new bijector, it is a good idea to include comparisons like this to verify that the Jacobian is computed correctly. The strategy used above to get square Jacobians is quite generally applicable, and is used for testing the bijectors for (e.g.) simplices and Cholesky factors.</p><p>Returning to the Bijectors interface, because we have defined the forward transform as well as <code>logabsdetjac</code>, we can just use these to implement <code>with_logabsdet_jacobian</code>:</p><pre><code class="language-julia hljs">function Bijectors.with_logabsdet_jacobian(s::StereographicProj, x)
    return s(x), logabsdetjac(s, x)
end</code></pre><p>Or if we wanted to be more efficient, we might notice that <code>one(T) - x[3]</code> is computed both in <code>s(x)</code> as well as in <code>logabsdetjac</code>. So we could also write:</p><pre><code class="language-julia hljs">function Bijectors.with_logabsdet_jacobian(
    s::StereographicProj, x::AbstractVector{T}
) where {T&lt;:Real}
    denom = one(T) - x[3]  # Shared computation
    y = similar(x, 2)
    y[1] = x[1] / denom
    y[2] = x[2] / denom
    logjac = -log(abs(x[3])) - (2 * log(denom))
    return y, logjac
end</code></pre><p>Of course, this alone is unlikely to save any meaningful amount of time, but other bijectors may have more expensive computations that may be shared between both transform and log-Jacobian calculations.</p><p>The inverse bijector can be implemented in a very similar way (Wikipedia has the formulae as well), but is left as an exercise for the very willing reader!</p><p>Finally, suppose we had a distribution <code>UnitSphere</code>, where <code>rand(UnitSphere())</code> returned a random point on the unit sphere. Something similar to this technically exists in Manifolds.jl, but we can also define a hacky version ourselves:</p><pre><code class="language-julia hljs">using Distributions

struct UnitSphere &lt;: Distributions.ContinuousMultivariateDistribution end
Base.size(::UnitSphere) = (3,)
Base.rand(::UnitSphere) = normalize(rand(3))</code></pre><p>Then, we could define</p><pre><code class="language-julia hljs">Bijectors.bijector(::UnitSphere) = StereographicProj()

# Not strictly needed for this example, but other usage may require it
Bijectors.output_size(::StereographicProj, ::UnitSphere) = (2,)</code></pre><p>and that would allow us to construct, for example, transformed distributions:</p><pre><code class="language-julia hljs">td = transformed(UnitSphere())
rand(td)  # returns a random point in ℝ²</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.1658922646425023
 2.04962106949887</code></pre><p>We didn&#39;t define <code>logpdf</code> for <code>UnitSphere</code>, but if we had, then we would also be able to make use of <code>logpdf(td, y)</code> and <code>Bijectors.logpdf_with_trans</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../defining/">« Defining a bijector</a><a class="docs-footer-nextpage" href="../advi/">Example: Variational inference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 1 December 2025 11:12">Monday 1 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
